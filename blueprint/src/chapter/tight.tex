\chapter{Tight families of measures}

\begin{definition}\label{def:tight}
\lean{MeasureTheory.IsTightMeasureSet} \mathlibok
A set $S$ of measures on $\Omega$ is tight if for all $\varepsilon > 0$ there exists a compact set $K$ such that for all $\mu \in S$, $\mu(K^c) \le \varepsilon$.
\end{definition}


\begin{lemma}\label{lem:isTightMeasureSet_iff_norm}
\uses{def:tight}
\leanok
\lean{isTightMeasureSet_iff_tendsto_measure_norm_gt}
Let $S$ be a set of measures on a finite-dimensional normed space $E$. 
Then $S$ is tight iff $\lim_{r \to +\infty}\sup_{\mu \in S} \mu\{\Vert x \Vert > r\} = 0$.
\end{lemma}

\begin{proof}\leanok

\end{proof}
	

\begin{lemma}\label{lem:isTightMeasureSet_iff_sup_basis}
\uses{def:tight}
\leanok
\lean{isTightMeasureSet_iff_forall_basis_tendsto}
Let $S$ be a set of measures on a finite-dimensional inner product space $E$. 
Let $b_1, \ldots, b_k$ be an orthonormal basis of $E$.
The $S$ is tight iff for all $i \in \{1, \ldots, k\}$, $\lim_{r \to +\infty}\sup_{\mu \in S} \mu\{\vert\langle b_i, x\rangle\vert > r\} = 0$.
\end{lemma}

\begin{proof}\leanok
\uses{lem:isTightMeasureSet_iff_norm}
\end{proof}


\begin{lemma}\label{lem:isTightMeasureSet_iff_basis}
\uses{def:tight}
\leanok
\lean{isTightMeasureSet_iff_forall_basis_tendsto_limsup}
Let $(\mu_n)_{n \in \mathbb{N}}$ be a sequence of measures on a finite-dimensional inner product space $E$. 
Let $b_1, \ldots, b_k$ be an orthonormal basis of $E$.
Then the set $\{\mu_n \mid n \in \mathbb{N}\}$ is tight iff for all $i \in \{1, \ldots, k\}$, $\lim_{r \to +\infty}\limsup_{n \to \infty} \mu_n\{\vert\langle b_i, x\rangle\vert > r\} = 0$.
\end{lemma}

\begin{proof}\leanok
\uses{lem:isTightMeasureSet_iff_sup_basis}
\end{proof}


\begin{lemma}\label{lem:tight_of_cvg}
\uses{def:tight}
If $\mu_1, \mu_2, \ldots$ converge weakly to $\mu$, then $\{\mu_n \mid n \in \mathbb{N}\}$ is tight.
\end{lemma}

\begin{proof}
Fix $r > 0$ and let $f(x) = (1 - (r - \vert x \vert)_+)_+$ . $f$ is a bounded continuous function. Then
\begin{align*}
\limsup_{n \to +\infty} \mu_n\{\vert X \vert > r\}
\le \lim_{n \to +\infty} \mu_n\left[ f \right]
= \mu[f]
\le \mu\{\vert X \vert > r - 1\} \: .
\end{align*}
As $r \to +\infty$, the last quantity tends to 0.
\end{proof}


\begin{lemma}\label{tight_iff_cvg_probability}
\uses{def:tight, def:cvg_probability}
For random variables $(X_i)_{i \in \mathbb{N}}$ (TODO in which kind of space?), the two following conditions are equivalent:
\begin{itemize}
	\item $(\mathcal L(X_n))$ is tight,
	\item For all $(c_n) \ge 0$ with $c_n \to 0$, $c_n X_n \xrightarrow{p} 0$.
\end{itemize}
\end{lemma}

\begin{proof}

\end{proof}


\begin{lemma}\label{tight_closure}
\uses{def:tight}
The closure of a tight set of measures is tight.
\end{lemma}

\begin{proof}
\end{proof}



\section{Prokhorov's theorem}

% \begin{lemma}\label{lem:exists_finite_union_inter_lt}
% Let $(U_n)_{n \in \mathbb{N}}$ be open sets in a complete separable metric space $E$ such that $\bigcup_{n=1}^{+ \infty} U_n = E$. Let $\Gamma$ be a relatively compact set of probability measures on $E$ for the topology of weak convergence of measures. Then for all $\varepsilon > 0$ there exists a finite set $S \subseteq \mathbb{N}$ such that for all $\mu \in \Gamma$, $\mu(\bigcup_{n \in S} U_n) > 1 - \varepsilon$.
% \end{lemma}

% \begin{proof}
% \end{proof}

% \begin{lemma}\label{lem:prokhorov_aux1}
% \uses{def:tight}
% Let $E$ be a complete separable metric space and let $S \subseteq \mathcal P(E)$. If the closure of $S$ is compact, then $S$ is tight.
% \end{lemma}

% \begin{proof}\uses{lem:exists_finite_union_inter_lt}
% \end{proof}

% \begin{theorem}[Riesz-Markov-Kakutani representation theorem, for compact spaces]\label{thm:riesz_markov_kakutani}
% Let $E$ be a compact T2 space and let $\psi$ be a positive linear functional on $C(E, \mathbb{C})$. There exists a regular measure $\mu$ finite on compacts such that
% \begin{align*}
% \forall f \in C(E, \mathbb{C}), \ \psi(f) = \int_{x \in E} f(x) \partial\mu(x) \: .
% \end{align*}
% \end{theorem}

% \begin{proof}
% \end{proof}

% \begin{lemma}\label{lem:ProbabilityMeasure_compact}
% If $E$ is a compact metric space, then $\mathcal P(E)$ with the Prokhorov metric is a compact metric space.
% \end{lemma}

% \begin{proof}\uses{thm:riesz_markov_kakutani}
% \end{proof}

\begin{theorem}[Prokhorov's theorem]\label{thm:prokhorov}
\notready
\lean{isTightMeasureSet_iff_isCompact_closure}
Let $E$ be a complete separable metric space and let $S \subseteq \mathcal P(E)$. Then the following are equivalent:
\begin{enumerate}
	\item $S$ is tight.
	\item the closure of $S$ is compact.
\end{enumerate}
\end{theorem}

\begin{proof}
\end{proof}


\begin{lemma}\label{lem:relatively_compact_of_tight}
\leanok
\lean{isCompact_closure_of_isTightMeasureSet}
Let $E$ be a metric space and let $S \subseteq \mathcal P(E)$ be tight. Then the closure of $S$ is compact.
\end{lemma}

\begin{proof}\uses{thm:prokhorov}
\end{proof}
