\chapter{The central limit theorem}


\begin{lemma}[Concavity]\label{concave}
  \lean{Real.strictConcaveOn_negMulLog}\leanok
  $h$ is strictly concave on $[0,1]$.
\end{lemma}

\begin{proof} \leanok Check that $h'$ is strictly monotone decreasing.
\end{proof}

\begin{lemma}[Jensen]\label{jensen}
  \lean{Real.sum_negMulLog_le} \leanok
  If $S$ is a finite set, and $\sum_{s \in S} w_s = 1$ for some non-negative $w_s$, and $p_s \in [0,1]$ for all $s \in S$, then
  $$ \sum_{s \in S} w_s h(p_s) \leq h(\sum_{s \in S} w_s p_s).$$
\end{lemma}

\begin{proof} \uses{concave}\leanok Apply Jensen and Lemma \ref{concave}.
\end{proof}

\begin{lemma}[Converse Jensen]\label{converse-jensen}
  \lean{Real.sum_negMulLog_eq}\leanok
If equality holds in the above lemma, then $p_s = \sum_{s \in S} w_s h(p_s)$ whenever $w_s \neq 0$.
\end{lemma}

\begin{proof} \uses{concave}\leanok Need some converse form of Jensen, not sure if it is already in Mathlib.  May also wish to state it as an if and only if.
\end{proof}

\begin{theorem}[Central limit theorem]\label{clt}
Let $\xi_1, \xi_2, \ldots$ be i.i.d. random variables with mean 0 and variance 1, and let $\zeta$ be a random variable with law $\mathcal N(0,1)$. Then
\begin{align*}
\frac{1}{\sqrt{n}}\sum_{k=1}^n \xi_k \xrightarrow{d} \zeta \: .
\end{align*}
\end{theorem}

\begin{proof}
\end{proof}
