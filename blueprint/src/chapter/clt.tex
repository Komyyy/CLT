\chapter{The central limit theorem}

\begin{lemma}\label{lem:deriv_charFun}
\leanok
\lean{iteratedDeriv_charFun}
\uses{def:charFun}
Let $X$ be a real random variable with characteristic function $\phi$ with $\mathbb{E}[\vert X \vert^n] < \infty$ and let $k \le n$.
Then the $k$\textsuperscript{th} derivative of $\phi$ is 
$\phi^{(k)}(t) = \mathbb{E}[i X]^k e^{i t X}$ \: .
\end{lemma}

\begin{proof}\leanok
\uses{lem:charFun_contDiff}
\end{proof}


\begin{lemma}\label{lem:charFun_taylor}
\leanok
\lean{taylor_charFun}
Let $X$ be a real random variable with characteristic function $\phi$, with $\mathbb{E}[\vert X \vert^n] < \infty$. Then as $t \to 0$,
\begin{align*}
\phi(t) = \sum_{k=0}^n \frac{(it)^k \mathbb{E}[X^k]}{k!} + o(t^n)
\: .
\end{align*}
\end{lemma}

\begin{proof}\leanok
\uses{lem:deriv_charFun}
\end{proof}


\begin{theorem}[Central limit theorem]\label{clt}
    \leanok
    \lean{central_limit}
Let $X_1, X_2, \ldots$ be i.i.d. real random variables with mean 0 and variance 1, and let $Z$ be a random variable with law $\mathcal N(0,1)$. Then
\begin{align*}
\frac{1}{\sqrt{n}}\sum_{k=1}^n X_k \xrightarrow{d} Z \: .
\end{align*}
\end{theorem}

\begin{proof}\uses{lem:charFun_smul, lem:charFun_add_of_indep, thm:charFun_tendsto_iff_measure_tendsto, lem:charFun_taylor, lem:gaussian_charFun}
\leanok
Let $S_n = \frac{1}{\sqrt{n}}\sum_{k=1}^n X_k$. Let $\phi$ be the characteristic function of $X_k$. By Lemma~\ref{lem:charFun_smul} and~\ref{lem:charFun_add_of_indep}, the characteristic function of $S_n$ is $\phi_n(t) = (\phi(n^{-1/2}t))^n$.

By Lemma \ref{lem:charFun_taylor},
\begin{align*}
\phi_n(t) = (\phi(n^{-1/2}t))^n = \left(1 - \frac{1}{2n}t^2 + o(\frac{1}{n})\right)^n \to_{n \to +\infty} e^{-t^2/2} \: .
\end{align*}

Since the r.h.s. is the characteristic function of $Z$, we conclude that $\frac{1}{\sqrt{n}}\sum_{k=1}^n X_k \xrightarrow{d} Z$ by Lemma~\ref{thm:charFun_tendsto_iff_measure_tendsto}.
\end{proof}
